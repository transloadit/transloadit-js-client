{"version":3,"sources":["../../src/plugins/Plugin.test.js"],"names":["getFormData","require","nanoraf","yo","findDOMElement","Plugin","jest","mock","fn","mockImplementation","foo","cb","some","describe","plugin","afterEach","mockClear","it","expect","toBe","length","opts","MockPlugin","core","id","mockState","state","plugins","getPluginState","initialState","hello","asdf","setState","patch","setPluginState","not","toEqual","beforeEach","render","ren","prototype","update","updateUI","undefined","calls","el","toThrow","addTarget","mockCore","iteratePlugins","mockTarget","log","setMeta","mockPlugin","yoUpdateSpy","spyOn","getMetaFromForm","mockReset","mockRestore","mount","assertions","mockElement","appendChild","nodeName","innerHTML","test","replaceTargetContent","target","unmount","removeChild","parentNode","install","uninstall","spy"],"mappings":"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","file":"Plugin.test.js","sourcesContent":["const getFormData = require('get-form-data')\nconst nanoraf = require('nanoraf')\nconst yo = require('yo-yo')\n\nconst { findDOMElement } = require('../core/Utils')\nconst Plugin = require('./Plugin')\n\njest.mock('get-form-data')\njest.mock('nanoraf')\njest.mock('../core/Utils', () => ({\n  findDOMElement: jest.fn()\n}))\n\ngetFormData.mockImplementation(() => ({ foo: 'bar' }))\nnanoraf.mockImplementation(cb => {\n  cb({ some: 'state' }) // eslint-disable-line standard/no-callback-literal\n  return () => {}\n})\n\ndescribe('Plugin', () => {\n  let plugin\n\n  afterEach(() => {\n    getFormData.mockClear()\n  })\n\n  it('is a class', () => {\n    expect(typeof Plugin).toBe('function')\n  })\n\n  it('accepts two parameters', () => {\n    expect(Plugin.length).toBe(2)\n  })\n\n  it('defaults options when not passed as an argument', () => {\n    plugin = new Plugin()\n    expect(typeof plugin.opts).toBe('object')\n  })\n\n  describe('plugin state', () => {\n    class MockPlugin extends Plugin {\n      constructor (core, opts) {\n        super(core, opts)\n        this.id = 'MockPlugin'\n      }\n    }\n    it('returns plugin state from `getPluginState()`', () => {\n      const mockState = {}\n      plugin = new MockPlugin({\n        state: {\n          plugins: {\n            MockPlugin: mockState\n          }\n        }\n      })\n\n      expect(plugin.getPluginState()).toBe(mockState)\n    })\n\n    it('merges plugin state using `setPluginState()`', () => {\n      const initialState = {\n        plugins: {\n          MockPlugin: {\n            hello: 'world',\n            asdf: 'quux'\n          }\n        }\n      }\n\n      plugin = new MockPlugin({\n        setState (patch) {\n          this.state = Object.assign({}, this.state, patch)\n        },\n        state: initialState\n      })\n\n      plugin.setPluginState({ hello: 'friends' })\n\n      expect(plugin.core.state).not.toBe(initialState)\n      expect(plugin.getPluginState()).toEqual({\n        hello: 'friends',\n        asdf: 'quux'\n      })\n    })\n  })\n\n  // it('sets `replaceTargetContent` based on options argument', () => {\n  //   plugin = new Plugin(null, { replaceTargetContent: false })\n  //   expect(plugin.opts.replaceTargetContent).toBe(false)\n  // })\n\n  // it('defaults `replaceTargetContent` to true when not passed as an option', () => {\n  //   plugin = new Plugin()\n  //   expect(plugin.opts.replaceTargetContent).toBe(true)\n  // })\n\n  describe('.update', () => {\n    beforeEach(() => {\n      plugin = new Plugin()\n      plugin.render = jest.fn(() => ({ ren: 'der' }))\n    })\n\n    it('is a function', () => {\n      expect(typeof Plugin.prototype.update).toBe('function')\n    })\n\n    it('accepts one parameter', () => {\n      expect(Plugin.prototype.update.length).toBe(1)\n    })\n\n    it('does nothing when plugin has no UI element (`el`)', () => {\n      plugin.updateUI = jest.fn()\n      expect(plugin.update()).toBe(undefined)\n      expect(plugin.updateUI.mock.calls.length).toBe(0)\n    })\n\n    it('calls updateUI method with state when UI element (`el`) exists', () => {\n      plugin.el = {}\n      plugin.updateUI = jest.fn()\n      plugin.update({ foo: 'bar' })\n      expect(plugin.updateUI.mock.calls.length).toBe(1)\n      expect(plugin.updateUI.mock.calls[0][0]).toEqual({ foo: 'bar' })\n    })\n\n    it('does nothing when a UI element exists but and no updateUI method', () => {\n      plugin.el = {}\n      expect(() => plugin.update()).not.toThrow()\n    })\n  })\n\n  describe('.mount', () => {\n    const addTarget = jest.fn(() => 'body')\n    const mockCore = {\n      iteratePlugins: (cb) => {\n        cb(new mockTarget()) // eslint-disable-line new-cap\n      },\n      log: jest.fn(),\n      setMeta: jest.fn(),\n      state: 'default'\n    }\n    const mockPlugin = {\n      id: 'pID'\n    }\n    const mockTarget = function () {\n      this.id = 'tID'\n      this.addTarget = addTarget\n    }\n\n    let yoUpdateSpy\n\n    beforeEach(() => {\n      yoUpdateSpy = jest.spyOn(yo, 'update').mockImplementation(() => ({ yo: 'el' }))\n      plugin = new Plugin(mockCore, { getMetaFromForm: true })\n      plugin.render = jest.fn(() => ({ ren: 'der' }))\n    })\n\n    afterEach(() => {\n      findDOMElement.mockReset()\n      findDOMElement.mockRestore()\n      mockCore.log.mockReset()\n      mockCore.setMeta.mockReset()\n      yoUpdateSpy.mockReset()\n      yoUpdateSpy.mockRestore()\n    })\n\n    it('is a function', () => {\n      expect(typeof Plugin.prototype.mount).toBe('function')\n    })\n\n    it('accepts two parameters', () => {\n      expect(Plugin.prototype.mount.length).toBe(2)\n    })\n\n    it('adds updateUI method', () => {\n      plugin.mount(mockTarget, mockPlugin)\n      expect(typeof plugin.updateUI).toBe('function')\n    })\n\n    it('sets `el` property when state has changed', () => {\n      expect.assertions(4)\n\n      expect(plugin.el).toBe(undefined)\n\n      plugin.mount(mockTarget, mockPlugin)\n\n      expect(plugin.render.mock.calls[0][0]).toEqual({ some: 'state' })\n      expect(yo.update.mock.calls[0]).toEqual([undefined, { ren: 'der' }])\n      expect(plugin.el).toEqual({ yo: 'el' })\n    })\n\n    describe('when target is a DOM element', () => {\n      let mockElement\n      const appendChild = jest.fn()\n\n      beforeEach(() => {\n        mockElement = {\n          nodeName: 'FORM',\n          innerHTML: 'foo',\n          appendChild\n        }\n        mockPlugin.render = jest.fn(() => ({ el: 'lo' }))\n        findDOMElement.mockImplementation(() => mockElement)\n      })\n\n      afterEach(() => {\n        findDOMElement.mockReset()\n        findDOMElement.mockRestore()\n      })\n\n      it('logs installation', () => {\n        plugin.mount(mockTarget, mockPlugin)\n        expect(mockCore.log.mock.calls.length).toBe(1)\n        expect(/DOM element/.test(mockCore.log.mock.calls[0][0])).toBe(true)\n      })\n\n      it('sets form data to core\\'s meta data when target is a form', () => {\n        plugin.mount(mockTarget, mockPlugin)\n        expect(getFormData.mock.calls[0][0]).toEqual(mockElement)\n        expect(mockCore.setMeta.mock.calls[0][0]).toEqual({ foo: 'bar' })\n      })\n\n      it('does not set data to core\\'s meta data when `getMetaFromForm` isn\\'t a Plugin option', () => {\n        plugin = new Plugin(mockCore)\n        plugin.render = () => {}\n        plugin.mount(mockTarget, mockPlugin)\n        expect(mockCore.setMeta.mock.calls.length).toBe(0)\n      })\n\n      it('does not set data to core\\'s meta data when target is not a form', () => {\n        mockElement.nodeName = 'FOO'\n\n        plugin.mount(mockTarget, mockPlugin)\n        expect(mockCore.setMeta.mock.calls.length).toBe(0)\n      })\n\n      it('does not remove content from target when `replaceTargetContent` is not set', () => {\n        plugin = new Plugin(mockCore)\n        plugin.render = () => {}\n        plugin.mount(mockTarget, mockPlugin)\n        expect(mockElement.innerHTML).toBe('foo')\n      })\n\n      it('removes content from target when `replaceTargetContent` is set', () => {\n        plugin = new Plugin(mockCore, {replaceTargetContent: true})\n        plugin.render = () => {}\n        plugin.mount(mockTarget, mockPlugin)\n        expect(mockElement.innerHTML).toBe('')\n      })\n\n      it('sets `el` to plugin rendered with state', () => {\n        plugin.mount(mockTarget, mockPlugin)\n        expect(mockPlugin.render.mock.calls[0][0]).toBe('default')\n        expect(plugin.el).toEqual({ el: 'lo' })\n      })\n\n      it('appends plugin\\'s element to target', () => {\n        plugin.mount(mockTarget, mockPlugin)\n        expect(mockElement.appendChild.mock.calls[0][0]).toEqual({ el: 'lo' })\n      })\n\n      it('returns the target DOM element', () => {\n        plugin = new Plugin(mockCore, {replaceTargetContent: true})\n        plugin.render = () => {}\n        const target = plugin.mount(mockTarget, mockPlugin)\n        expect(target).toEqual({\n          nodeName: 'FORM',\n          innerHTML: '',\n          appendChild\n        })\n      })\n    })\n\n    describe('when target is a plugin', () => {\n      it('logs installation', () => {\n        plugin.mount(mockTarget, mockPlugin)\n        expect(mockCore.log.mock.calls.length).toBe(1)\n        expect(/tID/.test(mockCore.log.mock.calls[0][0])).toBe(true)\n      })\n\n      it('adds plugin to target', () => {\n        plugin.mount(mockTarget, mockPlugin)\n        expect(addTarget.mock.calls[0][0]).toEqual(mockPlugin)\n      })\n\n      it('returns plugin\\'s target', () => {\n        const target = plugin.mount(mockTarget, mockPlugin)\n        expect(target).toBe('body')\n      })\n    })\n  })\n\n  describe('.render', () => {\n    beforeEach(() => {\n      plugin = new Plugin()\n    })\n\n    it('is a function', () => {\n      expect(typeof Plugin.prototype.render).toBe('function')\n    })\n\n    it('accepts one parameter', () => {\n      expect(Plugin.prototype.render.length).toBe(1)\n    })\n\n    it('throws by default', () => {\n      expect(() => plugin.render()).toThrow()\n    })\n  })\n\n  describe('.addTarget', () => {\n    beforeEach(() => {\n      plugin = new Plugin()\n    })\n\n    it('is a function', () => {\n      expect(typeof Plugin.prototype.addTarget).toBe('function')\n    })\n\n    it('accepts one parameter', () => {\n      expect(Plugin.prototype.addTarget.length).toBe(1)\n    })\n\n    it('throws by default', () => {\n      expect(() => plugin.addTarget()).toThrow()\n    })\n  })\n\n  describe('.unmount', () => {\n    beforeEach(() => {\n      plugin = new Plugin()\n    })\n\n    it('is a function', () => {\n      expect(typeof Plugin.prototype.unmount).toBe('function')\n    })\n\n    it('removes plugin\\'s UI element', () => {\n      const removeChild = jest.fn()\n      const el = {\n        parentNode: {\n          removeChild\n        }\n      }\n      plugin.el = el\n      plugin.unmount()\n      expect(removeChild.mock.calls.length).toBe(1)\n      expect(removeChild.mock.calls[0][0]).toEqual(el)\n    })\n\n    it('does nothing when no UI element or parent', () => {\n      plugin.el = {}\n      expect(() => plugin.unmount()).not.toThrow()\n    })\n  })\n\n  describe('.install', () => {\n    it('is a function', () => {\n      expect(typeof Plugin.prototype.install).toBe('function')\n    })\n  })\n\n  describe('.uninstall', () => {\n    it('is a function', () => {\n      expect(typeof Plugin.prototype.uninstall).toBe('function')\n    })\n\n    it('calls unmount method', () => {\n      const spy = jest.spyOn(Plugin.prototype, 'unmount')\n      const plugin = new Plugin()\n      plugin.uninstall()\n      expect(spy.mock.calls.length).toBe(1)\n      spy.mockReset()\n      spy.mockRestore()\n    })\n  })\n})\n"]}