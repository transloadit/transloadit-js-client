{"version":3,"sources":["../../src/plugins/Redux.js"],"names":["Plugin","require","module","exports","core","opts","type","id","title","action","Error","dispatch","handleStateUpdate","bind","prev","state","patch","install","emitter","on","uninstall","off"],"mappings":";;;;;;;;AAAA,IAAMA,SAASC,QAAQ,UAAR,CAAf;;AAEAC,OAAOC,OAAP;AAAA;;AACE,iBAAaC,IAAb,EAAmBC,IAAnB,EAAyB;AAAA;;AAAA,iDACvB,mBAAMD,IAAN,EAAYC,IAAZ,CADuB;;AAEvB,UAAKC,IAAL,GAAY,YAAZ;AACA,UAAKC,EAAL,GAAU,OAAV;AACA,UAAKC,KAAL,GAAa,eAAb;;AAEA,QAAI,OAAOH,KAAKI,MAAZ,KAAuB,WAA3B,EAAwC;AACtC,YAAM,IAAIC,KAAJ,CAAU,8BAAV,CAAN;AACD;AACD,QAAI,OAAOL,KAAKM,QAAZ,KAAyB,WAA7B,EAA0C;AACxC,YAAM,IAAID,KAAJ,CAAU,gCAAV,CAAN;AACD;AACD,UAAKL,IAAL,GAAYA,IAAZ;;AAEA,UAAKO,iBAAL,GAAyB,MAAKA,iBAAL,CAAuBC,IAAvB,OAAzB;AAduB;AAexB;;AAhBH,kBAkBED,iBAlBF,8BAkBqBE,IAlBrB,EAkB2BC,KAlB3B,EAkBkCC,KAlBlC,EAkByC;AACrC,SAAKX,IAAL,CAAUM,QAAV,CAAmB,KAAKN,IAAL,CAAUI,MAAV,CAAiBK,IAAjB,EAAuBC,KAAvB,EAA8BC,KAA9B,CAAnB,EADqC,CACoB;AAC1D,GApBH;;AAAA,kBAsBEC,OAtBF,sBAsBa;AACT,SAAKb,IAAL,CAAUc,OAAV,CAAkBC,EAAlB,CAAqB,mBAArB,EAA0C,KAAKP,iBAA/C;AACA,SAAKA,iBAAL,CAAuB,EAAvB,EAA2B,KAAKR,IAAL,CAAUW,KAArC,EAA4C,KAAKX,IAAL,CAAUW,KAAtD,EAFS,CAEoD;AAC9D,GAzBH;;AAAA,kBA2BEK,SA3BF,wBA2Be;AACX,SAAKhB,IAAL,CAAUc,OAAV,CAAkBG,GAAlB,CAAsB,mBAAtB,EAA2C,KAAKT,iBAAhD;AACD,GA7BH;;AAAA;AAAA,EAAqCZ,MAArC","file":"Redux.js","sourcesContent":["const Plugin = require('./Plugin')\n\nmodule.exports = class Redux extends Plugin {\n  constructor (core, opts) {\n    super(core, opts)\n    this.type = 'state-sync'\n    this.id = 'Redux'\n    this.title = 'Redux Emitter'\n\n    if (typeof opts.action === 'undefined') {\n      throw new Error('action option is not defined')\n    }\n    if (typeof opts.dispatch === 'undefined') {\n      throw new Error('dispatch option is not defined')\n    }\n    this.opts = opts\n\n    this.handleStateUpdate = this.handleStateUpdate.bind(this)\n  }\n\n  handleStateUpdate (prev, state, patch) {\n    this.opts.dispatch(this.opts.action(prev, state, patch)) // this dispatches a redux event with the new state\n  }\n\n  install () {\n    this.core.emitter.on('core:state-update', this.handleStateUpdate)\n    this.handleStateUpdate({}, this.core.state, this.core.state) // set the initial redux state\n  }\n\n  uninstall () {\n    this.core.emitter.off('core:state-update', this.handleStateUpdate)\n  }\n}\n"]}