{"version":3,"sources":["../../../src/plugins/Dashboard/index.js"],"names":["Plugin","require","Translator","dragDrop","Dashboard","StatusBar","Informer","findAllDOMElements","prettyBytes","defaultTabIcon","module","exports","core","opts","id","title","type","defaultLocale","strings","selectToUpload","closeModal","upload","importFrom","dashboardWindowTitle","dashboardTitle","copyLinkToClipboardSuccess","copyLinkToClipboardFallback","fileSource","done","localDisk","myDevice","dropPasteImport","dropPaste","browse","fileProgress","numberOfSelectedFiles","uploadAllNewFiles","defaultOptions","target","getMetaFromForm","trigger","inline","width","height","semiTransparent","showProgressDetails","hideUploadButton","note","closeModalOnClickOutside","locale","onRequestCloseModal","translator","containerWidth","translate","bind","requestCloseModal","openModal","isModalOpen","addTarget","actions","hideAllPanels","showPanel","initEvents","handleEscapeKeyPress","handleClickOutside","handleFileCard","handleDrop","pauseAll","resumeAll","cancelAll","updateDashboardElWidth","render","install","plugin","callerPluginId","constructor","name","callerPluginName","callerPluginType","msg","log","isHidden","state","getPluginState","newTargets","targets","slice","push","setPluginState","activePanel","filter","savedDocumentScrollPosition","window","scrollY","document","body","classList","add","style","top","querySelector","focus","setTimeout","remove","scrollTo","event","keyCode","showModalTrigger","forEach","addEventListener","removeDragDropListener","el","files","removeEvents","removeEventListener","on","removeActions","off","dashboardEl","offsetWidth","fileId","fileCardFor","file","addFile","source","data","emit","pluginState","newFiles","Object","keys","progress","uploadStarted","inProgressFiles","uploadComplete","isPaused","inProgressFilesArray","totalSize","totalUploadedSize","bytesTotal","bytesUploaded","acquirers","getPlugin","icon","progressindicators","startUpload","ev","catch","err","stack","message","cancelUpload","fileID","showFileCard","fileCardDone","meta","modal","totalFileCount","length","totalProgress","autoProceed","i18n","removeFile","info","metaFields","resumableUploads","capabilities","pauseUpload","pauseResume","retryUpload","maxWidth","maxHeight","currentWidth","isWide","discoverProviderPlugins","iteratePlugins","mount","plugins","pluginID","disableStatusBar","use","disableInformer","uninstall","informer","removePlugin","statusBar","unmount"],"mappings":"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","file":"index.js","sourcesContent":["const Plugin = require('../Plugin')\nconst Translator = require('../../core/Translator')\nconst dragDrop = require('drag-drop')\nconst Dashboard = require('./Dashboard')\nconst StatusBar = require('../StatusBar')\nconst Informer = require('../Informer')\nconst { findAllDOMElements } = require('../../core/Utils')\nconst prettyBytes = require('prettier-bytes')\nconst { defaultTabIcon } = require('./icons')\n\n/**\n * Modal Dialog & Dashboard\n */\nmodule.exports = class DashboardUI extends Plugin {\n  constructor (core, opts) {\n    super(core, opts)\n    this.id = 'Dashboard'\n    this.title = 'Dashboard'\n    this.type = 'orchestrator'\n\n    const defaultLocale = {\n      strings: {\n        selectToUpload: 'Select files to upload',\n        closeModal: 'Close Modal',\n        upload: 'Upload',\n        importFrom: 'Import files from',\n        dashboardWindowTitle: 'Uppy Dashboard Window (Press escape to close)',\n        dashboardTitle: 'Uppy Dashboard',\n        copyLinkToClipboardSuccess: 'Link copied to clipboard.',\n        copyLinkToClipboardFallback: 'Copy the URL below',\n        fileSource: 'File source',\n        done: 'Done',\n        localDisk: 'Local Disk',\n        myDevice: 'My Device',\n        dropPasteImport: 'Drop files here, paste, import from one of the locations above or',\n        dropPaste: 'Drop files here, paste or',\n        browse: 'browse',\n        fileProgress: 'File progress: upload speed and ETA',\n        numberOfSelectedFiles: 'Number of selected files',\n        uploadAllNewFiles: 'Upload all new files'\n      }\n    }\n\n    // set default options\n    const defaultOptions = {\n      target: 'body',\n      getMetaFromForm: true,\n      trigger: '#uppy-select-files',\n      inline: false,\n      width: 750,\n      height: 550,\n      semiTransparent: false,\n      defaultTabIcon: defaultTabIcon(),\n      showProgressDetails: false,\n      hideUploadButton: false,\n      note: null,\n      closeModalOnClickOutside: false,\n      locale: defaultLocale,\n      onRequestCloseModal: () => this.closeModal()\n    }\n\n    // merge default options with the ones set by user\n    this.opts = Object.assign({}, defaultOptions, opts)\n\n    this.locale = Object.assign({}, defaultLocale, this.opts.locale)\n    this.locale.strings = Object.assign({}, defaultLocale.strings, this.opts.locale.strings)\n\n    this.translator = new Translator({locale: this.locale})\n    this.containerWidth = this.translator.translate.bind(this.translator)\n\n    this.closeModal = this.closeModal.bind(this)\n    this.requestCloseModal = this.requestCloseModal.bind(this)\n    this.openModal = this.openModal.bind(this)\n    this.isModalOpen = this.isModalOpen.bind(this)\n\n    this.addTarget = this.addTarget.bind(this)\n    this.actions = this.actions.bind(this)\n    this.hideAllPanels = this.hideAllPanels.bind(this)\n    this.showPanel = this.showPanel.bind(this)\n    this.initEvents = this.initEvents.bind(this)\n    this.handleEscapeKeyPress = this.handleEscapeKeyPress.bind(this)\n    this.handleClickOutside = this.handleClickOutside.bind(this)\n    this.handleFileCard = this.handleFileCard.bind(this)\n    this.handleDrop = this.handleDrop.bind(this)\n    this.pauseAll = this.pauseAll.bind(this)\n    this.resumeAll = this.resumeAll.bind(this)\n    this.cancelAll = this.cancelAll.bind(this)\n    this.updateDashboardElWidth = this.updateDashboardElWidth.bind(this)\n    this.render = this.render.bind(this)\n    this.install = this.install.bind(this)\n  }\n\n  addTarget (plugin) {\n    const callerPluginId = plugin.id || plugin.constructor.name\n    const callerPluginName = plugin.title || callerPluginId\n    // const callerPluginIcon = plugin.icon || this.opts.defaultTabIcon\n    const callerPluginType = plugin.type\n\n    if (callerPluginType !== 'acquirer' &&\n        callerPluginType !== 'progressindicator' &&\n        callerPluginType !== 'presenter') {\n      let msg = 'Dashboard: Modal can only be used by plugins of types: acquirer, progressindicator, presenter'\n      this.core.log(msg)\n      return\n    }\n\n    const target = {\n      id: callerPluginId,\n      name: callerPluginName,\n      // icon: callerPluginIcon,\n      type: callerPluginType,\n      // render: plugin.render,\n      isHidden: true\n    }\n\n    const state = this.getPluginState()\n    const newTargets = state.targets.slice()\n    newTargets.push(target)\n\n    this.setPluginState({\n      targets: newTargets\n    })\n\n    return this.target\n  }\n\n  hideAllPanels () {\n    this.setPluginState({\n      activePanel: false\n    })\n  }\n\n  showPanel (id) {\n    const { targets } = this.getPluginState()\n\n    const activePanel = targets.filter((target) => {\n      return target.type === 'acquirer' && target.id === id\n    })[0]\n\n    this.setPluginState({\n      activePanel: activePanel\n    })\n  }\n\n  requestCloseModal () {\n    if (this.opts.onRequestCloseModal) {\n      return this.opts.onRequestCloseModal()\n    } else {\n      this.closeModal()\n    }\n  }\n\n  openModal () {\n    this.setPluginState({\n      isHidden: false\n    })\n\n    // save scroll position\n    this.savedDocumentScrollPosition = window.scrollY\n\n    // add class to body that sets position fixed, move everything back\n    // to scroll position\n    document.body.classList.add('is-UppyDashboard-open')\n    document.body.style.top = `-${this.savedDocumentScrollPosition}px`\n\n    // focus on modal inner block\n    this.target.querySelector('.UppyDashboard-inner').focus()\n\n    // this.updateDashboardElWidth()\n    // to be sure, sometimes when the function runs, container size is still 0\n    setTimeout(this.updateDashboardElWidth, 500)\n  }\n\n  closeModal () {\n    this.setPluginState({\n      isHidden: true\n    })\n\n    document.body.classList.remove('is-UppyDashboard-open')\n\n    window.scrollTo(0, this.savedDocumentScrollPosition)\n  }\n\n  isModalOpen () {\n    return !this.getPluginState().isHidden || false\n  }\n\n  // Close the Modal on esc key press\n  handleEscapeKeyPress (event) {\n    if (event.keyCode === 27) {\n      this.requestCloseModal()\n    }\n  }\n\n  handleClickOutside () {\n    if (this.opts.closeModalOnClickOutside) this.requestCloseModal()\n  }\n\n  initEvents () {\n    // Modal open button\n    const showModalTrigger = findAllDOMElements(this.opts.trigger)\n    if (!this.opts.inline && showModalTrigger) {\n      showModalTrigger.forEach(trigger => trigger.addEventListener('click', this.openModal))\n    }\n\n    if (!this.opts.inline && !showModalTrigger) {\n      this.core.log('Dashboard modal trigger not found, you won’t be able to select files. Make sure `trigger` is set correctly in Dashboard options', 'error')\n    }\n\n    document.body.addEventListener('keyup', this.handleEscapeKeyPress)\n\n    // Drag Drop\n    this.removeDragDropListener = dragDrop(this.el, (files) => {\n      this.handleDrop(files)\n    })\n  }\n\n  removeEvents () {\n    const showModalTrigger = findAllDOMElements(this.opts.trigger)\n    if (!this.opts.inline && showModalTrigger) {\n      showModalTrigger.forEach(trigger => trigger.removeEventListener('click', this.openModal))\n    }\n\n    this.removeDragDropListener()\n    document.body.removeEventListener('keyup', this.handleEscapeKeyPress)\n  }\n\n  actions () {\n    this.core.on('core:file-added', this.hideAllPanels)\n    this.core.on('dashboard:file-card', this.handleFileCard)\n\n    window.addEventListener('resize', this.updateDashboardElWidth)\n  }\n\n  removeActions () {\n    window.removeEventListener('resize', this.updateDashboardElWidth)\n\n    this.core.off('core:file-added', this.hideAllPanels)\n    this.core.off('dashboard:file-card', this.handleFileCard)\n  }\n\n  updateDashboardElWidth () {\n    const dashboardEl = this.target.querySelector('.UppyDashboard-inner')\n    this.core.log(`Dashboard width: ${dashboardEl.offsetWidth}`)\n\n    this.setPluginState({\n      containerWidth: dashboardEl.offsetWidth\n    })\n  }\n\n  handleFileCard (fileId) {\n    this.setPluginState({\n      fileCardFor: fileId || false\n    })\n  }\n\n  handleDrop (files) {\n    this.core.log('[Dashboard] Files were dropped')\n\n    files.forEach((file) => {\n      this.core.addFile({\n        source: this.id,\n        name: file.name,\n        type: file.type,\n        data: file\n      })\n    })\n  }\n\n  cancelAll () {\n    this.core.emit('core:cancel-all')\n  }\n\n  pauseAll () {\n    this.core.emit('core:pause-all')\n  }\n\n  resumeAll () {\n    this.core.emit('core:resume-all')\n  }\n\n  render (state) {\n    const pluginState = this.getPluginState()\n    const files = state.files\n\n    const newFiles = Object.keys(files).filter((file) => {\n      return !files[file].progress.uploadStarted\n    })\n    const inProgressFiles = Object.keys(files).filter((file) => {\n      return !files[file].progress.uploadComplete &&\n             files[file].progress.uploadStarted &&\n             !files[file].isPaused\n    })\n\n    let inProgressFilesArray = []\n    inProgressFiles.forEach((file) => {\n      inProgressFilesArray.push(files[file])\n    })\n\n    let totalSize = 0\n    let totalUploadedSize = 0\n    inProgressFilesArray.forEach((file) => {\n      totalSize = totalSize + (file.progress.bytesTotal || 0)\n      totalUploadedSize = totalUploadedSize + (file.progress.bytesUploaded || 0)\n    })\n    totalSize = prettyBytes(totalSize)\n    totalUploadedSize = prettyBytes(totalUploadedSize)\n\n    const acquirers = pluginState.targets.filter(target => {\n      const plugin = this.core.getPlugin(target.id)\n      target.icon = plugin.icon || this.opts.defaultTabIcon\n      target.render = plugin.render\n      return target.type === 'acquirer'\n    })\n\n    const progressindicators = pluginState.targets.filter(target => {\n      const plugin = this.core.getPlugin(target.id)\n      target.icon = plugin.icon || this.opts.defaultTabIcon\n      target.render = plugin.render\n      return target.type === 'progressindicator'\n    })\n\n    const startUpload = (ev) => {\n      this.core.upload().catch((err) => {\n        // Log error.\n        this.core.log(err.stack || err.message || err)\n      })\n    }\n\n    const cancelUpload = (fileID) => {\n      this.core.emit('core:upload-cancel', fileID)\n      this.core.emit('core:file-remove', fileID)\n    }\n\n    const showFileCard = (fileID) => {\n      this.core.emit('dashboard:file-card', fileID)\n    }\n\n    const fileCardDone = (meta, fileID) => {\n      this.core.emit('core:update-meta', meta, fileID)\n      this.core.emit('dashboard:file-card')\n    }\n\n    return Dashboard({\n      state: state,\n      modal: pluginState,\n      newFiles: newFiles,\n      files: files,\n      totalFileCount: Object.keys(files).length,\n      totalProgress: state.totalProgress,\n      acquirers: acquirers,\n      activePanel: pluginState.activePanel,\n      getPlugin: this.core.getPlugin,\n      progressindicators: progressindicators,\n      autoProceed: this.core.opts.autoProceed,\n      hideUploadButton: this.opts.hideUploadButton,\n      id: this.id,\n      closeModal: this.requestCloseModal,\n      handleClickOutside: this.handleClickOutside,\n      showProgressDetails: this.opts.showProgressDetails,\n      inline: this.opts.inline,\n      semiTransparent: this.opts.semiTransparent,\n      showPanel: this.showPanel,\n      hideAllPanels: this.hideAllPanels,\n      log: this.core.log,\n      i18n: this.containerWidth,\n      pauseAll: this.pauseAll,\n      resumeAll: this.resumeAll,\n      addFile: this.core.addFile,\n      removeFile: this.core.removeFile,\n      info: this.core.info,\n      note: this.opts.note,\n      metaFields: state.metaFields,\n      resumableUploads: this.core.state.capabilities.resumableUploads || false,\n      startUpload: startUpload,\n      pauseUpload: this.core.pauseResume,\n      retryUpload: this.core.retryUpload,\n      cancelUpload: cancelUpload,\n      fileCardFor: pluginState.fileCardFor,\n      showFileCard: showFileCard,\n      fileCardDone: fileCardDone,\n      updateDashboardElWidth: this.updateDashboardElWidth,\n      maxWidth: this.opts.maxWidth,\n      maxHeight: this.opts.maxHeight,\n      currentWidth: pluginState.containerWidth,\n      isWide: pluginState.containerWidth > 400\n    })\n  }\n\n  discoverProviderPlugins () {\n    this.core.iteratePlugins((plugin) => {\n      if (plugin && !plugin.target && plugin.opts && plugin.opts.target === this.constructor) {\n        this.addTarget(plugin)\n      }\n    })\n  }\n\n  install () {\n    // Set default state for Modal\n    this.setPluginState({\n      isHidden: true,\n      showFileCard: false,\n      activePanel: false,\n      targets: []\n    })\n\n    const target = this.opts.target\n\n    if (target) {\n      this.mount(target, this)\n    }\n\n    const plugins = this.opts.plugins || []\n    plugins.forEach((pluginID) => {\n      const plugin = this.core.getPlugin(pluginID)\n      if (plugin) plugin.mount(this, plugin)\n    })\n\n    if (!this.opts.disableStatusBar) {\n      this.core.use(StatusBar, {\n        target: this\n      })\n    }\n\n    if (!this.opts.disableInformer) {\n      this.core.use(Informer, {\n        target: this\n      })\n    }\n\n    this.discoverProviderPlugins()\n\n    this.initEvents()\n    this.actions()\n  }\n\n  uninstall () {\n    if (!this.opts.disableInformer) {\n      const informer = this.core.getPlugin('Informer')\n      if (informer) this.core.removePlugin(informer)\n    }\n\n    if (!this.opts.disableStatusBar) {\n      const statusBar = this.core.getPlugin('StatusBar')\n      // Checking if this plugin exists, in case it was removed by uppy-core\n      // before the Dashboard was.\n      if (statusBar) this.core.removePlugin(statusBar)\n    }\n\n    const plugins = this.opts.plugins || []\n    plugins.forEach((pluginID) => {\n      const plugin = this.core.getPlugin(pluginID)\n      if (plugin) plugin.unmount()\n    })\n\n    this.unmount()\n    this.removeActions()\n    this.removeEvents()\n  }\n}\n"]}